
---
import MarqueeBanner from '../components/MarqueeBanner.astro';
---

<section class="certified-facility-section relative w-full h-[90vh] overflow-hidden bg-cover bg-center" style="background-image: url('/fondo6.png');">
  <div class="absolute top-0 left-0 w-full z-20">
    <MarqueeBanner />
  </div>

  <div class="relative flex flex-col md:flex-row items-center justify-center h-full z-10 max-w-6xl mx-auto gap-4 md:gap-8" style="padding-top: 20px;">
    <div class="flex flex-col justify-center items-center text-center md:text-left md:items-start md:justify-center md:max-w-[800px] md:pl-8 lg:pl-16 xl:pl-24">
      <div class="max-w-7xl flex flex-col items-center gap-0">
        <div class="title-line1 font-antonioLight text-[#01ffff] cf-title1 text-[clamp(2.86rem,4.1vw,4.85rem)] animated-title mb-0" style="line-height:1; margin-bottom:0;">STATE-OF-THE-ART</div>
        <div class="title-line2 font-antonioLight text-[#01ffff] cf-title2 text-[clamp(2.86rem,4.1vw,4.85rem)] animated-title mt-[-0.9em] mb-2 md:mb-3" style="line-height:1; margin-top:-0.3em;">MANUFACTURING</div>
        <div class="title-line3 font-antonioLight text-[#01ffff] leading-none cf-title3 text-[clamp(5rem,7vw,8.4rem)] lg:-ml-4 animated-title mb-4 md:mb-6">IN DALLAS, TX</div>
      </div>
      <p class="description font-montserrat font-extralight text-white text-[20px] lg:-ml-4 max-w-2xl w-full text-center md:text-center md:mx-0 mt-8 md:mt-10 leading-tight md:leading-snug cf-desc">
        <span class="block w-full text-center lg:-ml-19 md:text-left md:pl-8 lg:pl-16 xl:pl-24">Our fully certified facility is built for</span>
        <span class="block w-full text-center lg:-ml-19 md:text-left md:pl-8 lg:pl-16 xl:pl-24 tracking-normal" style="letter-spacing: -0.04em;">performance, scale, and speed.</span>
      </p>
    </div>
    <div class="w-full flex items-center justify-center mb-6 md:mb-0 hero-right">
      <img 
        src="/mapa6.png" 
        alt="Mapa" 
        class="cf-map drop-shadow-xl w-[200px] sm:w-[300px] lg:w-[480px] transition-transform duration-300" 
        style="z-index:2;" 
      />
    </div>
  </div>

  <div class="absolute bottom-0 left-0 w-full z-20">
    <MarqueeBanner />
  </div>
</section>

<style>
  .font-antonioLight {
    font-family: 'Antonio Light', 'Antonio', sans-serif;
    font-weight: 300;
  }
  .font-montserrat {
    font-family: 'Montserrat', sans-serif;
  }
  .marquee-text {
    will-change: transform;
    display: inline-block;
    padding-left: 100vw;
    /* Espaciado para loop */
  }
  /* Media queries utilidades */
  @layer utilities {
    .title-line1 {
      letter-spacing: 0.0em;
    }
    .title-line2 {
      letter-spacing: 0.00em;
    }
    .title-line3 {
      letter-spacing: 0.01em;
    }
    @media (max-width: 600px) {
      .title-line1 { font-size: 2.5rem !important; letter-spacing: 0.01em !important; }
      .title-line2 { font-size: 2.5rem !important; letter-spacing: 0.035em !important; }
      .title-line3 { font-size: 3.5rem !important; letter-spacing: 0.0em !important; }
      .marquee-text { font-size: 2.2rem !important; }
      .description { font-size: 1rem !important; line-height: 1.1 !important; margin-top: 1.5rem !important; letter-spacing: -0.07em !important;}
      
    }
    @media (min-width: 601px) and (max-width: 1024px) {
      .title-line1 { font-size: 3.5rem !important; letter-spacing: -0.01em !important; }
      .title-line2 { font-size: 3.5rem !important; letter-spacing: 0.01em !important; }
      .title-line3 { font-size: 5.8rem !important; letter-spacing: -0.065em !important; }
      .marquee-text { font-size: 3.5rem !important; }
      .description { font-size: 1rem !important; line-height: 1.15 !important; margin-top: 1.5rem !important;letter-spacing: 0.0em !important; }
    }
    @media (min-width: 1025px) {
      .title-line1 { letter-spacing: 0.0em !important; }
      .title-line2 {  letter-spacing: 0.03em !important; }
      .title-line3 {  letter-spacing: -0.069em !important; }
      
       }
  }
  .animated-title {
    transition: transform 0.25s cubic-bezier(0.4,0,0.2,1), box-shadow 0.25s cubic-bezier(0.4,0,0.2,1);
    will-change: transform;
    cursor: pointer;
  }
  .animated-title:hover {
    transform: scale(1.08);
    box-shadow: 0 6px 32px 0 rgba(1,255,255,0.18);
  }
</style>

<script>
  import { gsap } from 'gsap';
  window.addEventListener('DOMContentLoaded', () => {
    // Animación banners
    const banners = [
      document.querySelector('#banner-top .marquee-text'),
      document.querySelector('#banner-bottom .marquee-text')
    ];
    banners.forEach(banner => {
      if (banner && banner instanceof HTMLElement) {
        const textWidth = banner.offsetWidth;
        gsap.to(banner, {
          x: () => `-${textWidth}px`,
          duration: 18,
          ease: 'linear',
          repeat: -1,
          modifiers: {
            x: gsap.utils.unitize(x => parseFloat(x) % (textWidth + window.innerWidth))
          }
        });
      }
    });

    // Animación de entrada texto
    const animateText = () => {
      const tl = gsap.timeline();
      tl.from('.cf-title1', { y: 60, opacity: 0, duration: 0.6, ease: 'power3.out' });
      tl.from('.cf-title2', { y: 40, opacity: 0, duration: 0.5, ease: 'power3.out' }, '-=0.4');
      tl.from('.cf-title3', { y: 30, opacity: 0, duration: 0.5, ease: 'power2.out' }, '-=0.3');
      tl.from('.cf-desc', { y: 20, opacity: 0, duration: 0.4, ease: 'power2.out' }, '-=0.3');
    };
    // Intersection Observer para animar al entrar en viewport
    const section = document.querySelector('.certified-facility-section');
    if (section) {
      const observer = new window.IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            animateText();
          }
        });
      }, { threshold: 0.4 });
      observer.observe(section);
    }

    // Animación hover mapa
    const map = document.querySelector('.cf-map');
    if (map) {
      map.addEventListener('mouseenter', () => {
        gsap.to(map, { scale: 1.15, duration: 0.4, ease: 'power2.out' });
      });
      map.addEventListener('mouseleave', () => {
        gsap.to(map, { scale: 1, duration: 0.4, ease: 'power2.out' });
      });
    }
  });
</script>

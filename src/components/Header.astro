---
import '../styles/global.css';
---

<header class="bg-transparent fixed w-full top-0 z-50 py-5 font-bold font-[Montserrat]">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex items-center justify-between h-20 space-x-10">
      <!-- Logo -->
      <div class="flex items-center">
        <div class="flex-shrink-0 flex items-center">
          <div class="mr-3">
            <img src="/src/assets/LOGO.png" alt="Safeguard Laboratories Logo" class="w-60 object-contain">
          </div>
        </div>
      </div>

      <!-- Navigation -->
    <nav class="hidden xl:block">
      <div class="flex items-baseline space-x-13 lg:gap-5">
        <a href="#why-choose-us" class="header-nav-link text-black hover:text-blue-600 text-sm font-medium uppercase tracking-wide relative overflow-hidden ">
        <span class="relative z-10 text-xl">WHY CHOOSE US</span>
        <div class="nav-underline absolute bottom-0 left-0 w-0 h-0.5 bg-blue-600 transition-all duration-300"></div>
        </a>
        <a href="#solutions" class="header-nav-link text-black hover:text-blue-600 text-sm font-medium uppercase tracking-wide relative overflow-hidden ">
        <span class="relative z-10 text-xl">SOLUTIONS</span>
        <div class="nav-underline absolute bottom-0 left-0 w-0 h-0.5 bg-blue-600 transition-all duration-300"></div>
        </a>
        <a href="#from-lab-to-launch" class="header-nav-link text-black hover:text-blue-600 text-sm font-medium uppercase tracking-wide relative overflow-hidden ">
        <span class="relative z-10 text-xl">FROM LAB TO LAUNCH</span>
        <div class="nav-underline absolute bottom-0 left-0 w-0 h-0.5 bg-blue-600 transition-all duration-300"></div>
        </a>
        <a href="#contact" class="header-nav-link text-black hover:text-blue-600 text-sm font-medium uppercase tracking-wide relative overflow-hidden ">
        <span class="relative z-10 text-xl">CONTACT</span>
        <div class="nav-underline absolute bottom-0 left-0 w-0 h-0.5 bg-blue-600 transition-all duration-300"></div>
        </a>
      </div>
    </nav>

      <!-- Mobile menu button -->
      <div class="xl:hidden">
        <button id="mobile-menu-button" type="button" class="inline-flex items-center justify-center p-2 rounded-md text-gray-700 hover:text-blue-600 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500">
          <span class="sr-only ">Open main menu</span>
          <svg class="h-6 w-6" stroke="currentColor" fill="none" viewBox="0 0 24 24">
            <path class="hamburger-line" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
            <path class="close-line hidden" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>
    </div>
  </div>

  <!-- Mobile menu -->
  <div id="mobile-menu" class="xl:hidden hidden">
    <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
      <a href="#why-choose-us" class="mobile-nav-link block px-3 py-2 text-base font-medium text-black hover:text-blue-600 hover:bg-gray-50 uppercase tracking-wide ">
        WHY CHOOSE US
      </a>
      <a href="#solutions" class="mobile-nav-link block px-3 py-2 text-base font-medium text-black hover:text-blue-600 hover:bg-gray-50 uppercase tracking-wide ">
        SOLUTIONS
      </a>
      <a href="#from-lab-to-launch" class="mobile-nav-link block px-3 py-2 text-base font-medium text-black hover:text-blue-600 hover:bg-gray-50 uppercase tracking-wide ">
        FROM LAB TO LAUNCH
      </a>
      <a href="#contact" class="mobile-nav-link block px-3 py-2 text-base font-medium text-black hover:text-blue-600 hover:bg-gray-50 uppercase tracking-wide ">
        CONTACT
      </a>
    </div>
  </div>
</header>

<script>
  import { gsap } from 'gsap';
  import { ScrollTrigger } from 'gsap/ScrollTrigger';

  gsap.registerPlugin(ScrollTrigger);

  // Animaciones de entrada del header
  const headerTl = gsap.timeline();

  // Animación de los enlaces de navegación
  headerTl.from('.header-nav-link', {
    duration: 0.5,
    y: -20,
    opacity: 0,
    stagger: 0.1,
    ease: 'power2.out'
  }, '-=0.3');

  // Animación del botón móvil
  headerTl.from('#mobile-menu-button', {
    duration: 0.5,
    scale: 0,
    opacity: 0,
    ease: 'back.out(1.7)'
  }, '-=0.4');

  // Animaciones de hover para los enlaces de navegación
  document.querySelectorAll('.header-nav-link').forEach(link => {
    const underline = link.querySelector('.nav-underline');
    
    link.addEventListener('mouseenter', () => {
      gsap.to(underline, {
        duration: 0.1,
        width: '100%',
        ease: 'power2.out'
      });
    });

    link.addEventListener('mouseleave', () => {
      gsap.to(underline, {
        duration: 0.1,
        width: '0%',
        ease: 'power2.out'
      });
    });
  });

  // Animación de scroll para el header
  ScrollTrigger.create({
    trigger: 'body',
    start: 'top -10',
    end: 'bottom bottom',
    onEnter: () => {
      gsap.to('header', {
        duration: 0.3,
        backdropFilter: 'blur(10px)',
        ease: 'power2.out'
      });
    },
    onLeaveBack: () => {
      gsap.to('header', {
        duration: 0.3,
        backdropFilter: 'blur(0px)',
        ease: 'power2.out'
      });
    }
  });

  // Funcionalidad del menú móvil
  const mobileButton = document.querySelector('#mobile-menu-button');
  const mobileMenu = document.querySelector('#mobile-menu');
  const hamburgerLine = document.querySelector('.hamburger-line');
  const closeLine = document.querySelector('.close-line');
  let isMobileMenuOpen = false;

  if (mobileButton && mobileMenu && hamburgerLine && closeLine) {
    mobileButton.addEventListener('click', () => {
      isMobileMenuOpen = !isMobileMenuOpen;
      
      if (isMobileMenuOpen) {
        // Mostrar menú
        mobileMenu.classList.remove('hidden');
        hamburgerLine.classList.add('hidden');
        closeLine.classList.remove('hidden');
        
        // Animación de entrada
        gsap.fromTo(mobileMenu, 
          { opacity: 0, y: -20 },
          { duration: 0.3, opacity: 1, y: 0, ease: 'power2.out' }
        );
        
        // Animación de los enlaces
        gsap.fromTo('.mobile-nav-link', 
          { opacity: 0, x: -20 },
          { duration: 0.3, opacity: 1, x: 0, stagger: 0.1, ease: 'power2.out' }
        );
      } else {
        // Ocultar menú
        hamburgerLine.classList.remove('hidden');
        closeLine.classList.add('hidden');
        
        gsap.to(mobileMenu, {
          duration: 0.3,
          opacity: 0,
          y: -20,
          ease: 'power2.out',
          onComplete: () => {
            mobileMenu.classList.add('hidden');
          }
        });
      }
      
      // Animación del botón
      gsap.to(mobileButton, {
        duration: 0.2,
        scale: 0.95,
        ease: 'power2.out',
        onComplete: () => {
          gsap.to(mobileButton, {
            duration: 0.2,
            scale: 1,
            ease: 'back.out(1.7)'
          });
        }
      });
    });

    // Cerrar menú al hacer click en un enlace
    document.querySelectorAll('.mobile-nav-link').forEach(link => {
      link.addEventListener('click', () => {
        if (isMobileMenuOpen) {
          (mobileButton as HTMLButtonElement).click(); // Simular click del botón para cerrar
        }
      });
    });
  }

</script>

<style>
  header {
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
  }
</style>